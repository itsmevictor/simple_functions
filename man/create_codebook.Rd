% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create_codebook.R
\name{create_codebook}
\alias{create_codebook}
\title{Create a Codebook for a Dataset using an LLM (Single Query Version)}
\usage{
create_codebook(column_names, translate, context = NULL, chat = NULL, ...)
}
\arguments{
\item{column_names}{A character vector of the original column names.}

\item{translate}{A logical scalar. If TRUE, the function will ask the LLM
to translate non-English column names into English.}

\item{context}{An optional character string providing context about the
dataset (e.g., "This dataset contains customer purchase history.").}

\item{chat}{An optional \code{ellmer} Chat object. If NULL (default), a new
\code{chat_anthropic()} object will be created. This allows using pre-configured
chats (e.g., with specific models, parameters, or API keys).}

\item{...}{Additional arguments passed to \code{ellmer::chat_anthropic()} if \code{chat}
is NULL. Useful for specifying the model, API key, etc.
Example: \code{model = "claude-3-opus-20240229"}.}
}
\value{
A tibble containing the codebook. It will always have the
'original_name' and 'description' columns. If \code{translate} is TRUE,
it will also include a 'translated_name' column. Returns an empty tibble
with a warning if the LLM call fails or returns unexpected data.
}
\description{
This function takes a vector of column names and optionally dataset context,
then uses an LLM (defaults to Anthropic's Claude) via the 'ellmer' package
to generate descriptions for all columns in a single query. It can also
translate non-English column names.
}
\details{
Requires the \code{ellmer}, \code{dplyr}, \code{glue}, and \code{tibble} packages.
You need to have an Anthropic API key set up, typically via the
\code{ANTHROPIC_API_KEY} environment variable, unless you provide a \code{chat} object
that's already configured.
This version makes a single call to the LLM API, which can be more efficient
and provide better context for translations and descriptions compared to
making individual calls per column.
}
\examples{
\dontrun{
# Example: Needs ANTHROPIC_API_KEY environment variable set

cols_german <- c("Kundennummer", "Bestelldatum", "Produkt Name", "Menge", "Preis")
context_german <- "Datensatz Ã¼ber Kundenbestellungen in einem deutschen Online-Shop."

# Generate codebook with translation
codebook_german <- create_codebook(cols_german, translate = TRUE, context = context_german)
print(codebook_german)

# ---

cols_norwegian <- c(
  "Fylkenummer", "Fylkenavn", "Kommunenummer", "Kommunenavn",
  "Antall stemmeberettigede", "Godkjente stemmegivninger - Totalt"
)
context_norwegian <- "Dataset of Norwegian municipal election results."
codebook_norwegian <- create_codebook(cols_norwegian, translate = TRUE, context = context_norwegian)
print(codebook_norwegian)

# ---

cols_english <- c("customer_id", "order_date", "product_name", "quantity", "price")
context_english <- "Dataset about customer orders in an online store."

# Generate codebook without translation
codebook_english <- create_codebook(cols_english, translate = FALSE, context = context_english)
print(codebook_english)

# ---

# Using a specific model via ...
codebook_opus <- create_codebook(
  cols_english,
  translate = FALSE,
  context = context_english,
  model = "claude-3-opus-20240229"
)
print(codebook_opus)
}
}
